<link rel="import" href="../polymer/polymer.html">
<dom-module id="menu-item">
    <template>

        <style>
            :host{
                display: block;
                @apply(--menu-item-background);
            }
            .cus-btn{
                text-align: left;
                border-radius: 0;
                border: none;
                width: 100%;
                padding: 8px;
            }
            .glyphicon{
                color: green;
            }


            .tmpContainer{
               /* Refactor this EBP-CSS*/
               height: 480px;background-color: #f2f2f2;position: absolute;top:50px;left: 50px;padding: 10px;z-index: 900;


                -webkit-box-shadow: -1px 2px 5px 0px rgba(0,0,0,0.75);
                -moz-box-shadow: -1px 2px 5px 0px rgba(0,0,0,0.75);
                box-shadow: -1px 2px 5px 0px rgba(0,0,0,0.75);



            }





            .cus-btn:hover{
               @apply(--menuitem-hover-color);


            }

        </style>

        <div>
            <button  id="menuItem" type="button" class="btn btn-default btn-sm cus-btn" on-tap="handleOnTap" on-mouseover="handleMouseOver"
            on-mouseout="handleOnMouseOut">
                <span class$="{{icon}}" style$="color:{{iconColor}}"></span><span style="padding-left: 25px;">{{name}}</span>

            </button>

            <div id="container" class="shadow">
                <template is="dom-if" if="{{hidden}}">
                    <!-- dynamically change the content-->

                    <div class="tmpContainer">
                        <h3>{{name}}</h3>
                        <content></content>

                        <button  class="btn btn-primary btn-sm" on-tap="windowClose">CLOSE</button>
                    </div>
                </template>
            </div>


        </div>
        <div style="height: 2px;">&nbsp;</div>


    </template>
    <script>

        Polymer({
            is:'menu-item',
            properties:{
                name:{
                    type:String

                },
                id:{
                    type:String,//map to element name -> id=element name

                },
                hidden:{
                    type:Boolean,
                    value:false

                },
                leftPanel:String
            },
            handleOnMouseOut:function(){
                this.$.menuItem.style.position="static";
                this.iconColor="green";
               // this.$.menuItem.style.backgroundColor="white";
                this.$.menuItem.style.color="black";

            },
            handleMouseOver:function(){
                this.$.menuItem.style.position="relative";
                this.iconColor="#ffffff";
               // this.$.menuItem.style.backgroundColor="green";
                this.$.menuItem.style.color="white";
                this.$.menuItem.style.zIndex="99999";


            },
            handleOnTap:function(){

                this.hidden=true;
                //$('#container').css('display','block');

                var width = $('.cus-btn').width();


                Polymer.dom(this).flush();
                $('.tmpContainer').css('width',width);

                console.log("WIDTH : "+width);
               
                this.$.menuItem.style.position="relative";
                this.icon="glyphicon glyphicon-pencil";

                this.loadTemplate('partials/'+this.id+'.html',this.id);

                //fire the event to rest the view-element
                 this.fire('width-reset',{width:"78%"});


            },

            windowClose:function(){
                console.log("windowClose");
                this.icon="glyphicon glyphicon-plus";
                this.hidden=false;

            },
            ready:function(){
                console.log(this.localName+" ready..."+this.width);
                console.log("WIDTH : "+$('.btn').width());
            },
            loadTemplate:function(path,element){

                this.importHref(path,function(e){
                    var newElement = document.createElement(element);
                    var nodes =   Polymer.dom(this).childNodes;
                    if(nodes==0 || nodes==1){
                        Polymer.dom(this).appendChild(newElement);
                    }

                },function(err){
                    console.log(err);
                });
            },
            attached:function(){
                this.icon="glyphicon glyphicon-plus";
                console.log(this.localName+" attached..."+this.width);
            }
        });
    </script>
</dom-module>